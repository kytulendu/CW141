                                  ตอนที่ 4

                        การใช้ MailMerge

          ในการพิมพ์จดหมายเวียนด้วยCUWRITERผู้ใช้สามารถสั่งการให้เปลี่ยนชื่อหรือที่อยู่ของจดหมาย 
แต่ละชุดได้ด้วยการใช้พิมพ์จดหมายต้นฉบับเพียงฉบับเดียว  และในจดหมายต้นฉบับนี้ในส่วนที่จะต้องเปลี่ยน 
แปลงให้กำหนดเป็นตัวแปร  ด้วยการตั้งชื่อให้สอดคล้องกับข้อมูลและกำกับด้วยเครื่องหมาย & ตั้งหน้าและหลัง  
ส่วนข้อมูลที่เป็นชื่อหรือที่อยู่ที่จะนำมาแทนที่ตัวแปรในจดหมายแต่ละฉบับ   ให้สร้างเก็บไว้ในอีกแฟ้มข้อมูลหนึ่ง   
ในลักษณะโครงสร้าง 1 รายการต่อ  1   บรรทัด    แต่ละเรื่องหรือเขตข้อมูลคั่นด้วยเครื่องหมาย ","  
ดังแสดงรายละเอียดพร้อมตัวอย่างต่อไปนี้
 
ลักษณะแฟ้มข้อมูล Merge file  :  เป็น Test file ธรรมดา ที่บอกค่าข้อมูลที่จะ Merge เข้า 
                               กับแฟ้มข้อมูลเอกสาร

ลักษณะโครงสร้าง               :  แต่ละบรรทัด แสดงข้อมูล 1 Record

รูปแบบ   :  fieldcontent1,fieldcontent2,fieldcontent3,,,

ตัวอย่าง     บุษบา พระจันทร์,นักวิจัย,บ.เคมีลูกหลวง จำกัด ถ.หลานหลวง,กรุงเทพฯ10100


การใช้               :  ใช้ร่วมกับ Dot Command โดยมีคำสั่งของDot  Command
                               ดังนี้

     1.  .df  :  ใช้ในการบอกชื่อแฟ้มข้อมูล MailMerge 
         รูปแบบ   :  .df filename

         ตัวอย่าง  :  .df b:mail.dat

     2.  .rv  :  ใช้บอกโครงสร้างของข้อมูล ใน record ของ Merge File ว่ามี Field อะไรบ้าง

        รูปแบบ    :  .rv field lay-out
                 โดยที่ field lay-out ประกอบด้วยชื่อ field ต่าง ๆ แยกโดยเครื่องหมาย ","
        ตัวอย่าง   :  ชื่อ,ตำแหน่ง,หน่วยงาน,ที่อยู่,จังหวัด,โทร
     3. .sk:   ใช้ในการ skip record ถัดไป  โดยปกติแล้วคำสั่งนี้จะนำไปวางไว้ที่ท้ายแฟ้มข้อมูล 
                 แต่อาจจะกำหนดที่ตำแหน่งใด ๆ ถ้าต้องการให้พิมพ์ record ถัดไป

        รูปแบบ    :  .sk


     ตัวอย่างการใช้งาน

          สมมติท่านได้รับมอบหมายจากหัวหน้างานให้พิมพ์จดหมาย เพื่อเชิญผู้ถือหุ้นมาประชุม  ซึ่งจำนวน 
ของผู้ถือหุ้นทั้งหมดมีจำนวน 80 คน ซึ่งเป็นการพิมพ์จดหมายที่มีข้อความแบบเดียวกันเป็นจำนวนมาก เพียงแต่มี 
การเปลี่ยนในชื่อ ตำแหน่ง และหน่วยงาน ในแต่ละฉบับนั้นที่ต้องทำการเปลี่ยนแปลง เพื่อความสะดวกรวดเร็ว 
ในการพิมพ์ จึงได้กำหนดการพิมพ์จดหมายแบบ  MailMerge  ดังนี้






















                           ตัวอย่างการพิมพ์จดหมายเชิญประชุม

     ให้สร้างแฟ้มข้อมูลขึ้นใหม่โดยใช้ชื่อแฟ้มข้อมูล"B:letter" จากนั้นให้พิมพ์ข้อความดังตัวอย่างต่อไปนี้

     .df  b:mail.dat
     .rv  ชื่อ,ตำแหน่ง,ที่อยู่,จังหวัด,รหัสผู้ถือหุ้น
                                                     บริษัท  เอกพล  จำกัด
                                                     123   ถ. ลูกหลวง 
                                                     แขวงจิตรลดา เขตดุสิต
                                                     กรุงเทพฯ 10200

                                     25  พฤษภาคม  2532.

          เรียน  คุณ &ชื่อ&
                &ตำแหน่ง&
                &ที่อยู่&
                &จังหวัด&
                &รหัสผู้ถือหุ้น&

                 ทางบริษัทมีความยินดีเป็นอย่างยิ่งที่จะขอเรียนเชิญท่านร่วมฟังสรุปผลงาน  และรายงาน 
          ความก้าวหน้าของทางบริษัท ที่ได้ดำเนินกิจการมาครบรอบระยะเวลา 1 ปี และรายงานงบกำไร
          ขาดทุนงบดุลและงบแสดงการเปลี่ยนแปลงฐานะทางการเงิน   ตลอดจนจัดสรรเงินปันผลให้กับ 
          ผู้ถือหุ้นทุกท่าน 

                 จึงขอเรียนเชิญผู้ถือหุ้นทุกท่าน       ร่วมประชุมและรับฟังคำสรุปผลงานของทางบริษัท  
          ในวันเสาร์ที่ 16 มิถุนายน 2532. เวลา 10.00 น. ณ ห้องประชุมใหญ่ ชั้น 7  อาคารเอกพล   
          และขอขอบพระคุณที่ให้เกียรติมาร่วมงานนี้ทุกท่าน

                                                     ขอแสดงความนับถือ


                                                    (นายพร้อม  เอกพล)
                                                  ประธานบริษัท เอกพล จำกัด
     .sk
     เมื่อพิมพ์เสร็จแล้ว ให้กด ^KS  เพื่อทำการเก็บบันทึกลงในจานแม่เหล็ก จากนั้นให้สร้างแฟ้มข้อมูลใหม่ 
ขึ้นมาอีกหนึ่งแฟ้ม  โดยใช้ชื่อว่า "B:mail.dat" แฟ้มข้อมูล "mail.dat" นี้   จะเป็นแฟ้มข้อมูลที่เก็บ 
รายชื่อและรายละเอียดต่างๆที่กำหนดไว้ของสมาชิกทั้งหมด โดยมีเครื่องหมาย ","  ขั้นส่วนประกอบต่าง ๆ 
และในส่วนใดที่กำหนดไว้แล้วแต่ไม่มีข้อมูลในส่วนนั้น ให้ใส่เครื่อง "," ลงไปอีกครั้ง ดังตัวอย่างต่อไปนี้


วันชัย  ไทยเจริญดี,สถาปนิก,บ.ก่อสร้าง จำกัด สี่พระยา บางรัก,กรุงเทพฯ 10500,105422
พล เอกพล,ผู้จัดการ,บ.มิตรเอกพล จำกัด ถ.นเรศ บางรัก,กรุงเทพฯ 10500,154875
แมน วทัญญู,,บ. อุตสาหกรรม จำกัด  ถ.ตรีมิตร ป้อมปราบ,กรุงเทพฯ 10100,547544


    เมื่อได้รายละเอียดตามที่ต้องการและจำนวนครบแล้ว  ให้ทำการเก็บบันทึกข้อมูลลงในแผ่นจานแม่เหล็ก  
โดยใช้ ^KS 

     สำหรับการพิมพ์ ให้เข้าสู่เมนูของการพิมพ์ "CUPRINT" โดยที่
     1.  กำหนดชื่อแฟ้มข้อมูลที่ต้องการพิมพ์ เป็น "b:letter"
     2.  จำนวนชุดที่พิมพ์ (COPY) การตั้งจำนวนชุดที่จะพิมพ์ให้ตรวจดูว่าจำนวนรายชื่อทั้งหมดมีเท่าไร เช่น
         มีจำนวนสมาชิกทั้งหมด 3 คน  ในส่วนของจำนวนชุดที่จะพิมพ์ให้ใส่ 3
               "ต้องการพิมพ์กี่ชุด : 3"
     3. ตรวจดูความเรียบร้อยของเครื่องพิมพ์ (Printer)  รหัสภาษาไทยบนเมนูให้ตรงกับข้อมูลที่ใช้พิมพ์  
         เป็นต้น
     4.  เมื่อเรียบร้อยแล้วให้เลื่อน Cursor ไปยังส่วนของ "เริ่มพิมพ์แฟ้มข้อมูล"

     ดังนั้น  เมื่อสั่งพิมพ์ออกทางกระดาษพิมพ์แล้ว   จะได้จดหมายที่มีลักษณะข้อความของจดหมายที่เหมือนกัน 
จำนวน 3 ฉบับ ดังนี้









                                                     บริษัท  เอกพล  จำกัด
                                                     123   ถ. ลูกหลวง 
                                                     แขวงจิตรลดา เขตดุสิต
                                                     กรุงเทพฯ 10200

                                     25  พฤษภาคม  2532.

          เรียน  คุณ วันชัย  ไทยเจริญดี
                สถาปนิก
                บ.ก่อสร้าง จำกัด สี่พระยา บางรัก
                กรุงเทพฯ 10500
                105422

                 ทางบริษัทมีความยินดีเป็นอย่างยิ่งที่จะขอเรียนเชิญท่านร่วมฟังสรุปผลงาน  และรายงาน 
          ความก้าวหน้าของทางบริษัท ที่ได้ดำเนินกิจการมาครบรอบระยะเวลา 1 ปี และรายงานงบกำไร
          ขาดทุนงบดุลและงบแสดงการเปลี่ยนแปลงฐานะทางการเงิน   ตลอดจนจัดสรรเงินปันผลให้กับ 
          ผู้ถือหุ้นทุกท่าน 

                 จึงขอเรียนเชิญผู้ถือหุ้นทุกท่าน       ร่วมประชุมและรับฟังคำสรุปผลงานของทางบริษัท  
          ในวันเสาร์ที่ 16 มิถุนายน 2532. เวลา 10.00 น. ณ ห้องประชุมใหญ่ ชั้น 7  อาคารเอกพล   
          และขอขอบพระคุณที่ให้เกียรติมาร่วมงานนี้ทุกท่าน


                                                     ขอแสดงความนับถือ


                                                    (นายพร้อม  เอกพล)
                                                  ประธานบริษัท เอกพล จำกัด






                                                     บริษัท  เอกพล  จำกัด
                                                     123   ถ. ลูกหลวง 
                                                     แขวงจิตรลดา เขตดุสิต
                                                     กรุงเทพฯ 10200

                                     25  พฤษภาคม  2532.

          เรียน  คุณ พล เอกพล
                ผู้จัดการ
                บ.มิตรเอกพล จำกัด ถ.นเรศ บางรัก
                กรุงเทพฯ 10500
                154875


                 ทางบริษัทมีความยินดีเป็นอย่างยิ่งที่จะขอเรียนเชิญท่านร่วมฟังสรุปผลงาน  และรายงาน 
          ความก้าวหน้าของทางบริษัท ที่ได้ดำเนินกิจการมาครบรอบระยะเวลา 1 ปี และรายงานงบกำไร
          ขาดทุนงบดุลและงบแสดงการเปลี่ยนแปลงฐานะทางการเงิน   ตลอดจนจัดสรรเงินปันผลให้กับ 
          ผู้ถือหุ้นทุกท่าน 

                 จึงขอเรียนเชิญผู้ถือหุ้นทุกท่าน       ร่วมประชุมและรับฟังคำสรุปผลงานของทางบริษัท  
          ในวันเสาร์ที่ 16 มิถุนายน 2532. เวลา 10.00 น. ณ ห้องประชุมใหญ่ ชั้น 7  อาคารเอกพล   
          และขอขอบพระคุณที่ให้เกียรติมาร่วมงานนี้ทุกท่าน


                                                     ขอแสดงความนับถือ


                                                    (นายพร้อม  เอกพล)
                                                  ประธานบริษัท เอกพล จำกัด





                                                     บริษัท  เอกพล  จำกัด
                                                     123   ถ. ลูกหลวง 
                                                     แขวงจิตรลดา เขตดุสิต
                                                     กรุงเทพฯ 10200

                                     25  พฤษภาคม  2532.

          เรียน  คุณ แมน วทัญญู
                
                บ. อุตสาหกรรม จำกัด ถ.ตรีมิตร ป้อมปราบ
                กรุงเทพฯ 10100
                547544

                 ทางบริษัทมีความยินดีเป็นอย่างยิ่งที่จะขอเรียนเชิญท่านร่วมฟังสรุปผลงาน  และรายงาน 
          ความก้าวหน้าของทางบริษัท ที่ได้ดำเนินกิจการมาครบรอบระยะเวลา 1 ปี และรายงานงบกำไร
          ขาดทุนงบดุลและงบแสดงการเปลี่ยนแปลงฐานะทางการเงิน   ตลอดจนจัดสรรเงินปันผลให้กับ 
          ผู้ถือหุ้นทุกท่าน 

                 จึงขอเรียนเชิญผู้ถือหุ้นทุกท่าน       ร่วมประชุมและรับฟังคำสรุปผลงานของทางบริษัท  
          ในวันเสาร์ที่ 16 มิถุนายน 2532. เวลา 10.00 น. ณ ห้องประชุมใหญ่ ชั้น 7  อาคารเอกพล   
          และขอขอบพระคุณที่ให้เกียรติมาร่วมงานนี้ทุกท่าน



                                                     ขอแสดงความนับถือ


                                                    (นายพร้อม  เอกพล)
                                                  ประธานบริษัท เอกพล จำกัด





ข้อจำกัดของ MailMerge

     1.  จำนวน Field ที่ใช้จะต้องไม่เกิน 15 Field
     2.  ความยาวของชื่อ Field ที่กำหนดใน .rv command แต่ละตัวต้องไม่เกิน 20 ตัวอักษร
     3.ความยาวของค่าข้อมูล (Field Content) ไม่เกิน 40 ตัวอักษร
     4.  Field Lay-out ที่กำหนดใน .rv command ต้องอยู่ในบรรทัดเดียวกัน
     5.  ข้อมูลของแต่ละ Record ใน Merge File ต้องอยู่บรรทัดเดียวกัน